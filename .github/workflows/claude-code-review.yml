name: Claude Code Review

on:
 pull_request:
  type: [opened, synchronize] 

jobs:
  claude-review:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      id-token: write
      pull-request: read
      issues: read

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4
        with: 
        fetch-depth: 1

      - name: RUn Claude Code Review
        id: claude-review
        uses: anthropics/claude-code-action@main
        with:
          direrct_prompt: |
            Please review this PR. Look at the changes and provide thoughtful feedback on:
            - Code quality and best practices
            - Potential bugs or issues
            - Suggestions for improvements
            - Overall architecture and design decisions
            - Documentation consistency: Verify that README.md and other documentation files are updated to reflect any code changes (especially new inputs, features, or configuration options)
            Be constructive and specific in your feedback. Give inline comments where applicable
          anthropic_api_key: ${{ secrets.CLAUDE_AUTH_TOKEN }}
          allowed_tools: "mcp__github__create_pending_pull_request_review,mcp__github__add_comment_to_pending_review,mcp__github__submit_pending_pull_request_review,mcp__github__get_pull_request_diff"
